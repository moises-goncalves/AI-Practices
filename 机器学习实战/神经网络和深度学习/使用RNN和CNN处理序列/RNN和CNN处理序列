# 第十五章：RNN和CNN处理序列
1. 他们可以处理任意长度的序列 而常规的密集神经网络只能处理较小的序列

## 15.1 循环神经元和层：
1. 循环神经元同时处理当前的输入和上一个神经元的隐藏状态 在每个步长t接受输入xt和前一个时间不长y(t-1)的隐藏状态
2. 在第一步因为没有以前的输出 所以没有隐藏状态 也就是隐藏状态为0
3. 每个循环神经元都有两组权重 一组是输入权重wx 一组是隐藏状态权重wy 如果考虑整个循环层 可以将多个权重向量放在两个权重矩阵中计算整个循环层的输出向量

### 15.1.1 记忆单元：
1. 循环神经网络在时间步长上面保留某些状态的神经网络的一部分称为记忆单元 单个记忆单元存储的步长大概在10(具体取决于任务)
2. 在时间步长t的状态 ht是输入xt和前一个时间步长ht-1的函数

### 15.1.2 输入和输出序列：
1. RNN可以同时接受输入序列并产生输出序列 比如预测股票之类的变化
2. 或者可以向网络提供一个输入序列 忽略除了最后一个输出以外的所有输出 比如输入电影评论输出感情得分
3. 可以在每个时间步长中一次又一次的向网络提供相同的输入向量，并输出一个序列 成为向量到序列
4. 编码器和解码器，常见于句子翻译 编码器将语言转化为单个向量 然后解码器将向量解码为另一种语言的句子

## 15.2 训练RNN：
1. 训练的诀窍在于按照时间步逐步展开 然后使用反向传播 这种策略成为时间反向传播
2. 反向传播是通过成本函数的所有输出 而不是最终输出

## 15.3 预测时间序列：
1. 时间序列分为单变量时间序列和多变量时间序列 时间序列的典型任务有预测和根据数据填补空缺值 也就是插帧
2. 在处理时间序列数据时 输入特征通常表示为形状为[批处理大小，时间步长，维度]的三维数组 单变量时间序列维度为1 多变量时间维度更多

### 15.3.1 基准指标：
1. 均方根误差（RMSE）和平均绝对误差（MAE）是衡量预测时间序列性能的常用指标

### 15.3.2 实现一个简单的RNN：
1. SimpleRNN默认使用双曲正切函数 默认下Keras只返回最终输出 如果需要返回每个时间步长的输出 可以设置return_sequences=True
2. 趋势和季节性：可以使用加权移动平均模型或者自回归集成移动平均来进行时间序列预测 这种要求先删除季节性数据 在模型训练并做出预测后要添加季节性模式来得到最终输出

### 15.3.3 深度RNN：
1. 可以使用堆叠的RNN层来创建深度RNN