# MNIST手写数字识别

**难度**: ⭐⭐☆☆☆ (入门级)

基于卷积神经网络(CNN)的手写数字识别系统，实现MNIST数据集的高精度分类。

## 📋 项目概述

### 项目目标
构建一个深度学习模型，能够准确识别手写数字图像(0-9)，并达到工业级应用标准。

### 数据集说明
- **训练集**: 60,000张28×28灰度图像
- **测试集**: 10,000张28×28灰度图像
- **类别数**: 10个类别(0-9)
- **图像尺寸**: 28×28像素，单通道灰度图

### 数据集来源
- Keras内置数据集
- 官方网站: http://yann.lecun.com/exdb/mnist/

## 🚀 快速开始

### 1. 环境准备

```bash
# 安装依赖
pip install -r requirements.txt
```

### 2. 运行完整流程

```bash
# 训练模型
python src/train.py

# 评估模型
python src/evaluate.py

# 预测单张图片
python src/predict.py --image path/to/image.png
```

### 3. 使用Jupyter Notebook

```bash
# 启动Jupyter
jupyter notebook

# 打开notebooks目录下的文件
# 01_数据探索.ipynb - 探索MNIST数据集
# 02_简单CNN模型.ipynb - 构建基础CNN
# 03_改进模型.ipynb - 使用数据增强和正则化
# 04_模型对比.ipynb - 对比不同架构
```

### 4. 使用训练好的模型

```python
from src.model import MNISTPredictor
import numpy as np

# 加载模型
predictor = MNISTPredictor()
predictor.load_model('models/best_model.h5')

# 预测
image = np.random.rand(28, 28)  # 你的图像数据
prediction = predictor.predict(image)
print(f"预测结果: {prediction}")
```

## 📊 项目结构

```
mnist-cnn/
├── README.md              # 项目说明
├── requirements.txt       # 依赖包
├── data/                  # 数据目录(自动下载)
│   ├── raw/              # 原始数据
│   └── processed/        # 处理后数据
├── notebooks/            # Jupyter notebooks
│   ├── 01_数据探索.ipynb
│   ├── 02_简单CNN模型.ipynb
│   ├── 03_改进模型.ipynb
│   └── 04_模型对比.ipynb
├── src/                  # 源代码
│   ├── __init__.py
│   ├── data.py          # 数据加载和预处理
│   ├── model.py         # 模型定义
│   ├── train.py         # 训练脚本
│   ├── evaluate.py      # 评估脚本
│   └── predict.py       # 预测脚本
├── models/              # 保存的模型
│   └── best_model.h5
└── results/             # 结果和图表
    ├── training_history.png
    ├── confusion_matrix.png
    └── predictions.png
```

## 🔍 数据探索

### 数据集特点
- **平衡数据集**: 每个类别约6000张训练图像
- **归一化**: 像素值范围[0, 255]需要归一化到[0, 1]
- **简单背景**: 黑色背景，白色数字
- **居中对齐**: 数字已居中对齐

### 样本分布
```
训练集样本分布:
0: 5923张 (9.9%)
1: 6742张 (11.2%)
2: 5958张 (9.9%)
3: 6131张 (10.2%)
4: 5842张 (9.7%)
5: 5421张 (9.0%)
6: 5918张 (9.9%)
7: 6265张 (10.4%)
8: 5851张 (9.8%)
9: 5949张 (9.9%)
```

## 🛠️ 模型架构

### 基础CNN模型
```
Model: "mnist_cnn"
_________________________________________________________________
Layer (type)                Output Shape              Param #
=================================================================
conv2d_1 (Conv2D)          (None, 26, 26, 32)        320
max_pooling2d_1            (None, 13, 13, 32)        0
conv2d_2 (Conv2D)          (None, 11, 11, 64)        18496
max_pooling2d_2            (None, 5, 5, 64)          0
flatten                    (None, 1600)              0
dense_1 (Dense)            (None, 128)               204928
dropout                    (None, 128)               0
dense_2 (Dense)            (None, 10)                1290
=================================================================
Total params: 225,034
Trainable params: 225,034
```

### 改进模型特点
1. **数据增强**: 旋转、平移、缩放
2. **批标准化**: 加速训练，提高稳定性
3. **Dropout**: 防止过拟合
4. **学习率调度**: 动态调整学习率

## 📈 模型性能

### 基础模型
- **测试准确率**: 98.5%
- **训练时间**: ~5分钟 (CPU)
- **参数量**: 225K

### 改进模型
- **测试准确率**: 99.4%
- **训练时间**: ~10分钟 (CPU)
- **参数量**: 280K

### 各类别性能
| 数字 | 精确率 | 召回率 | F1分数 | 样本数 |
|-----|--------|--------|--------|--------|
| 0   | 0.995  | 0.997  | 0.996  | 980    |
| 1   | 0.997  | 0.998  | 0.997  | 1135   |
| 2   | 0.993  | 0.992  | 0.993  | 1032   |
| 3   | 0.992  | 0.993  | 0.993  | 1010   |
| 4   | 0.994  | 0.993  | 0.994  | 982    |
| 5   | 0.992  | 0.990  | 0.991  | 892    |
| 6   | 0.995  | 0.996  | 0.996  | 958    |
| 7   | 0.993  | 0.992  | 0.993  | 1028   |
| 8   | 0.990  | 0.991  | 0.991  | 974    |
| 9   | 0.991  | 0.990  | 0.991  | 1009   |

## 💡 项目亮点

1. **完整的深度学习流程**: 数据加载→模型构建→训练→评估→预测
2. **多种模型架构**: 简单CNN、改进CNN、ResNet风格
3. **数据增强**: 提升模型泛化能力
4. **可视化**: 训练曲线、混淆矩阵、预测结果
5. **模型保存和加载**: 便于部署和使用

## 📚 核心知识点

### 卷积神经网络基础
- **卷积层**: 通过卷积核提取图像特征，检测边缘、纹理和形状
- **池化层**: 降低特征维度，减少计算量，提供平移不变性
- **全连接层**: 整合特征信息，完成分类任务

### 训练技巧
- **数据归一化**: 将像素值标准化到[0,1]，加速收敛
- **批标准化**: 规范化层输入分布，稳定训练过程
- **Dropout**: 训练时随机丢弃神经元，防止过拟合
- **学习率调度**: 动态调整学习率，在平台期降低学习率

### 模型评估
- **准确率**: 整体预测正确的比例
- **精确率/召回率**: 针对每个类别的性能指标
- **混淆矩阵**: 可视化分类错误模式
- **错误样本分析**: 识别模型弱点

## 🎯 改进方向

### 1. 更深的网络
- 使用ResNet、VGG等经典架构
- 添加更多卷积层和残差连接

### 2. 数据增强
- 更激进的数据增强策略
- 使用Mixup、CutMix等高级技术

### 3. 集成学习
- 训练多个模型进行投票
- 结合不同架构的模型优势

### 4. 迁移学习
- 使用预训练模型
- 针对MNIST数据进行微调

### 5. 模型压缩
- 知识蒸馏: 用小模型学习大模型
- 模型剪枝: 删除冗余参数
- 量化: 降低参数精度

## 🔗 参考资源

### 数据集
- [MNIST官方网站](http://yann.lecun.com/exdb/mnist/)
- [Keras MNIST数据集](https://keras.io/api/datasets/mnist/)

### 论文
- LeCun et al. (1998) - Gradient-Based Learning Applied to Document Recognition
- He et al. (2015) - Deep Residual Learning for Image Recognition

### 教程
- [Deep Learning Book - CNN章节](http://www.deeplearningbook.org/)
- [CS231n: Convolutional Neural Networks](http://cs231n.stanford.edu/)

## 🤝 贡献

欢迎提交Issue和Pull Request改进项目。

## 📄 许可证

MIT License

---

**深度学习实践项目** - 从零开始构建工业级手写数字识别系统
