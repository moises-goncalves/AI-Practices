### 模型集成

## 每个模型都有其优缺点，单一模型往往难以兼顾所有方面的性能。模型集成通过结合多个模型的优势，提升整体性能和鲁棒性。

## 这种方法只有在几个模型表现没有明显差异时才有效。如果某个模型明显优于其他模型，集成可能会降低整体性能。

## Example：假设我们有三个不同的分类模型：模型A,模型B和模型C。每个模型在不同的数据子集上表现不同。通过集成这些模型，我们可以利用它们各自的优势，提升整体分类性能。

preds_a = model_a.predict(x_test)
preds_b = model_b.predict(x_test)
preds_c = model_c.predict(x_test)
preds_d = model_d.predict(x_test)


## 几种常见的集成方法：

1. 简单投票法
preds = np.argmax(np.vstack([preds_a, preds_b, preds_c, preds_d]), axis=0)

2. 或者使用平均概率
preds = np.mean([preds_a, preds_b, preds_c, preds_d], axis=0)

3. 或者使用加权平均概率 权重可以使用随机搜索或者简单的优化算法获得
preds = 0.25 * preds_a + 0.25 * preds_b + 0.25 * preds_c + 0.25 * preds_d

4. 或者使用最大概率
preds = np.max([preds_a, preds_b, preds_c, preds_d], axis=0)

## 注意事项
- 集成方法的效果取决于模型之间的差异和多样性
- 模型的偏差应该不能再同一个方向
- 集成的模型应该尽可能表现的同样好 但是要尽可能不同
- 一般有效的方法是集成一个深度学习神经模型和一个Traditional ML Model like Decision Tree, Random Forest, SVM等
